@* using get and set binding logic *@

@page "/ch02r04"
@rendermode InteractiveWebAssembly
@using BlazorCookbook.App.Client.Chapter2.Data

<h3>What's your name?</h3>
<input class="form-control w-50" @bind:event="oninput" @bind:get="@User" @bind:set="@AutocompleteAsync" /> @* example of get & set binding
                                                                                                              @bind:get tells the app where to retrive the input value
                                                                                                              @bind:set executes method after binding completes and sets the value parameter to the getter *@ 
                                                                                                                                                

<hr />

@if (!Suggestions.Any())
{
    return;
}

<h5>Did you mean?</h5>
@foreach (var name in Suggestions)
{
    <div>@name</div>
}

@code {
    protected string User = string.Empty;

    [Inject] private SuggestionsApi Api { get; init; }
    protected IList<string> Suggestions = [];

    private async Task AutocompleteAsync(string value)
    {
        User = value;
        Suggestions = string.IsNullOrWhiteSpace(User) ? [] : await Api.FindAsync(User);

        // ensures the UI re-renders safely and correctly after your async autocomplete call finishes.
        await InvokeAsync(StateHasChanged);
    }

}

